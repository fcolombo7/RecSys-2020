
SearchBayesianSkopt-CV: New best config found. Config 0: {'num_factors': 196, 'confidence_scaling': 'linear', 'alpha': 28.93616336481479, 'epsilon': 0.28164042337021666, 'reg': 1.6846374156796563e-05, 'epochs0': 20, 'epochs1': 10, 'epochs2': 35, 'epochs3': 15, 'epochs4': 15} - results: ROC_AUC: 0.1322972, PRECISION: 0.0270557, PRECISION_RECALL_MIN_DEN: 0.0997889, RECALL: 0.0971019, MAP: 0.0443624, MRR: 0.0943648, NDCG: 0.0682074, F1: 0.0423149, HIT_RATE: 0.2705566, ARHR: 0.1056611, NOVELTY: 0.0049230, AVERAGE_POPULARITY: 0.0694785, DIVERSITY_MEAN_INTER_LIST: 0.9944151, DIVERSITY_HERFINDAHL: 0.9994227, COVERAGE_ITEM: 0.3223869, COVERAGE_ITEM_CORRECT: 0.0369432, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1415880, DIVERSITY_GINI: 0.1174090, SHANNON_ENTROPY: 11.8174278, 
SearchBayesianSkopt-CV: Config 1 is suboptimal. Config: {'num_factors': 137, 'confidence_scaling': 'linear', 'alpha': 23.695687955960395, 'epsilon': 0.17261961025215072, 'reg': 0.007896872101870265, 'epochs0': 10, 'epochs1': 15, 'epochs2': 25, 'epochs3': 10, 'epochs4': 10} - results: ROC_AUC: 0.1332282, PRECISION: 0.0277085, PRECISION_RECALL_MIN_DEN: 0.1005086, RECALL: 0.0976276, MAP: 0.0439414, MRR: 0.0946055, NDCG: 0.0682305, F1: 0.0431640, HIT_RATE: 0.2770847, ARHR: 0.1063804, NOVELTY: 0.0047427, AVERAGE_POPULARITY: 0.0909417, DIVERSITY_MEAN_INTER_LIST: 0.9906141, DIVERSITY_HERFINDAHL: 0.9990426, COVERAGE_ITEM: 0.2305756, COVERAGE_ITEM_CORRECT: 0.0342868, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1437524, DIVERSITY_GINI: 0.0709844, SHANNON_ENTROPY: 11.0910937, 
SearchBayesianSkopt-CV: Config 2 is suboptimal. Config: {'num_factors': 164, 'confidence_scaling': 'log', 'alpha': 33.79427571671335, 'epsilon': 0.12667591408476594, 'reg': 0.0010668564763671804, 'epochs0': 10, 'epochs1': 15, 'epochs2': 35, 'epochs3': 10, 'epochs4': 20} - results: ROC_AUC: 0.1287497, PRECISION: 0.0264959, PRECISION_RECALL_MIN_DEN: 0.0973706, RECALL: 0.0946465, MAP: 0.0430371, MRR: 0.0919715, NDCG: 0.0663274, F1: 0.0413966, HIT_RATE: 0.2649588, ARHR: 0.1031933, NOVELTY: 0.0050328, AVERAGE_POPULARITY: 0.0619573, DIVERSITY_MEAN_INTER_LIST: 0.9954407, DIVERSITY_HERFINDAHL: 0.9995252, COVERAGE_ITEM: 0.3985833, COVERAGE_ITEM_CORRECT: 0.0368816, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1383415, DIVERSITY_GINI: 0.1576427, SHANNON_ENTROPY: 12.2007242, 

SearchBayesianSkopt-CV: New best config found. Config 3: {'num_factors': 126, 'confidence_scaling': 'log', 'alpha': 12.147774561179066, 'epsilon': 0.011140000925581263, 'reg': 0.00039864851116724637, 'epochs0': 10, 'epochs1': 30, 'epochs2': 20, 'epochs3': 15, 'epochs4': 10} - results: ROC_AUC: 0.1345524, PRECISION: 0.0276693, PRECISION_RECALL_MIN_DEN: 0.1020503, RECALL: 0.0992666, MAP: 0.0449636, MRR: 0.0963603, NDCG: 0.0694596, F1: 0.0432710, HIT_RATE: 0.2766934, ARHR: 0.1081451, NOVELTY: 0.0048581, AVERAGE_POPULARITY: 0.0796137, DIVERSITY_MEAN_INTER_LIST: 0.9928115, DIVERSITY_HERFINDAHL: 0.9992623, COVERAGE_ITEM: 0.3055399, COVERAGE_ITEM_CORRECT: 0.0356728, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1442054, DIVERSITY_GINI: 0.1022781, SHANNON_ENTROPY: 11.5690668, 
SearchBayesianSkopt-CV: Config 4 is suboptimal. Config: {'num_factors': 159, 'confidence_scaling': 'linear', 'alpha': 34.73658174305664, 'epsilon': 0.01526240076681221, 'reg': 2.5228629287364273e-05, 'epochs0': 20, 'epochs1': 15, 'epochs2': 55, 'epochs3': 20, 'epochs4': 10} - results: ROC_AUC: 0.1343982, PRECISION: 0.0277761, PRECISION_RECALL_MIN_DEN: 0.1017832, RECALL: 0.0989644, MAP: 0.0448183, MRR: 0.0958862, NDCG: 0.0692301, F1: 0.0433714, HIT_RATE: 0.2777606, ARHR: 0.1075690, NOVELTY: 0.0048710, AVERAGE_POPULARITY: 0.0759311, DIVERSITY_MEAN_INTER_LIST: 0.9934307, DIVERSITY_HERFINDAHL: 0.9993242, COVERAGE_ITEM: 0.2982868, COVERAGE_ITEM_CORRECT: 0.0365582, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1447590, DIVERSITY_GINI: 0.1030233, SHANNON_ENTROPY: 11.6167079, 
SearchBayesianSkopt-CV: Config 5 is suboptimal. Config: {'num_factors': 74, 'confidence_scaling': 'log', 'alpha': 12.640229618921357, 'epsilon': 7.453881874786568, 'reg': 1.4572856609023672e-05, 'epochs0': 50, 'epochs1': 15, 'epochs2': 45, 'epochs3': 20, 'epochs4': 15} - results: ROC_AUC: 0.0989999, PRECISION: 0.0201631, PRECISION_RECALL_MIN_DEN: 0.0668254, RECALL: 0.0645167, MAP: 0.0284907, MRR: 0.0703501, NDCG: 0.0460560, F1: 0.0307222, HIT_RATE: 0.2016314, ARHR: 0.0782776, NOVELTY: 0.0042986, AVERAGE_POPULARITY: 0.1678112, DIVERSITY_MEAN_INTER_LIST: 0.9584037, DIVERSITY_HERFINDAHL: 0.9958222, COVERAGE_ITEM: 0.0749490, COVERAGE_ITEM_CORRECT: 0.0156381, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1071348, DIVERSITY_GINI: 0.0144851, SHANNON_ENTROPY: 8.8314493, 
SearchBayesianSkopt-CV: Config 6 is suboptimal. Config: {'num_factors': 200, 'confidence_scaling': 'log', 'alpha': 10.0, 'epsilon': 0.01, 'reg': 0.01, 'epochs0': 10, 'epochs1': 10, 'epochs2': 35, 'epochs3': 10, 'epochs4': 15} - results: ROC_AUC: 0.1302638, PRECISION: 0.0266046, PRECISION_RECALL_MIN_DEN: 0.0981647, RECALL: 0.0955500, MAP: 0.0432072, MRR: 0.0926946, NDCG: 0.0668574, F1: 0.0416150, HIT_RATE: 0.2660465, ARHR: 0.1033613, NOVELTY: 0.0050251, AVERAGE_POPULARITY: 0.0613711, DIVERSITY_MEAN_INTER_LIST: 0.9955235, DIVERSITY_HERFINDAHL: 0.9995335, COVERAGE_ITEM: 0.3911684, COVERAGE_ITEM_CORRECT: 0.0376362, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1400277, DIVERSITY_GINI: 0.1546715, SHANNON_ENTROPY: 12.1892794, 
SearchBayesianSkopt-CV: Config 7 is suboptimal. Config: {'num_factors': 70, 'confidence_scaling': 'linear', 'alpha': 45.0, 'epsilon': 0.01, 'reg': 0.01, 'epochs0': 35, 'epochs1': 30, 'epochs2': 25, 'epochs3': 10, 'epochs4': 40} - results: ROC_AUC: 0.1300954, PRECISION: 0.0267722, PRECISION_RECALL_MIN_DEN: 0.0986181, RECALL: 0.0959893, MAP: 0.0420904, MRR: 0.0915215, NDCG: 0.0661611, F1: 0.0418640, HIT_RATE: 0.2677223, ARHR: 0.1020734, NOVELTY: 0.0046143, AVERAGE_POPULARITY: 0.1110705, DIVERSITY_MEAN_INTER_LIST: 0.9854084, DIVERSITY_HERFINDAHL: 0.9985222, COVERAGE_ITEM: 0.1661675, COVERAGE_ITEM_CORRECT: 0.0291434, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1419655, DIVERSITY_GINI: 0.0456168, SHANNON_ENTROPY: 10.4641144, 
SearchBayesianSkopt-CV: Config 8 Exception. Config: {'num_factors': 199, 'confidence_scaling': 'linear', 'alpha': 10.941557545341158, 'epsilon': 0.012883065952904471, 'reg': 3.857661896655542e-05} - Exception: Traceback (most recent call last):
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\ParameterTuningCV\SearchAbstractClass.py", line 421, in _objective_function
    result_dict_temp, result_string_temp, recommender_instance_temp, train_time_temp, evaluation_time_temp = self._evaluate_on_validation(current_fit_parameters_dict, i)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\ParameterTuningCV\SearchAbstractClass.py", line 312, in _evaluate_on_validation
    recommender_instance, train_time = self._fit_model(current_fit_parameters, index)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\ParameterTuningCV\SearchAbstractClass.py", line 302, in _fit_model
    **current_fit_parameters)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\MatrixFactorization\IALSRecommender.py", line 90, in fit
    **earlystopping_kwargs)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\Incremental_Training_Early_Stopping.py", line 192, in _train_with_early_stopping
    results_run, results_run_string = evaluator_object.evaluateRecommender(self)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\Evaluation\Evaluator.py", line 245, in evaluateRecommender
    results_dict = self._run_evaluation_on_selected_users(recommender_object, self.users_to_evaluate)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\Evaluation\Evaluator.py", line 449, in _run_evaluation_on_selected_users
    return_scores = True
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\BaseRecommender.py", line 156, in recommend
    relevant_items_partition = (-scores_batch).argpartition(cutoff, axis=1)[:,0:cutoff]
MemoryError

SearchBayesianSkopt-CV: Config 9 is suboptimal. Config: {'num_factors': 132, 'confidence_scaling': 'log', 'alpha': 11.16157982331137, 'epsilon': 1.017446335715253, 'reg': 0.0002541159563035432, 'epochs0': 10, 'epochs1': 20, 'epochs2': 10, 'epochs3': 25, 'epochs4': 25} - results: ROC_AUC: 0.1240140, PRECISION: 0.0255430, PRECISION_RECALL_MIN_DEN: 0.0900383, RECALL: 0.0873489, MAP: 0.0391300, MRR: 0.0883441, NDCG: 0.0615680, F1: 0.0395213, HIT_RATE: 0.2554299, ARHR: 0.0989223, NOVELTY: 0.0045888, AVERAGE_POPULARITY: 0.1099713, DIVERSITY_MEAN_INTER_LIST: 0.9856089, DIVERSITY_HERFINDAHL: 0.9985422, COVERAGE_ITEM: 0.1484196, COVERAGE_ITEM_CORRECT: 0.0285736, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1336605, DIVERSITY_GINI: 0.0409609, SHANNON_ENTROPY: 10.3548643, 
SearchBayesianSkopt-CV: Config 10 Exception. Config: {'num_factors': 77, 'confidence_scaling': 'linear', 'alpha': 40.41345808933866, 'epsilon': 0.057374413533289245, 'reg': 0.0005909832383769733} - Exception: Traceback (most recent call last):
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\ParameterTuningCV\SearchAbstractClass.py", line 421, in _objective_function
    result_dict_temp, result_string_temp, recommender_instance_temp, train_time_temp, evaluation_time_temp = self._evaluate_on_validation(current_fit_parameters_dict, i)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\ParameterTuningCV\SearchAbstractClass.py", line 312, in _evaluate_on_validation
    recommender_instance, train_time = self._fit_model(current_fit_parameters, index)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\ParameterTuningCV\SearchAbstractClass.py", line 302, in _fit_model
    **current_fit_parameters)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\MatrixFactorization\IALSRecommender.py", line 90, in fit
    **earlystopping_kwargs)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\Incremental_Training_Early_Stopping.py", line 192, in _train_with_early_stopping
    results_run, results_run_string = evaluator_object.evaluateRecommender(self)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\Evaluation\Evaluator.py", line 245, in evaluateRecommender
    results_dict = self._run_evaluation_on_selected_users(recommender_object, self.users_to_evaluate)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\Evaluation\Evaluator.py", line 449, in _run_evaluation_on_selected_users
    return_scores = True
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\BaseRecommender.py", line 128, in recommend
    scores_batch = self._compute_item_score(user_id_array, items_to_compute=items_to_compute)
  File "C:\Users\gio_d\Documents\Projects\RecSys\RecSys-2020\Base\BaseMatrixFactorizationRecommender.py", line 59, in _compute_item_score
    item_scores = np.dot(self.USER_factors[user_id_array], self.ITEM_factors.T)
MemoryError

SearchBayesianSkopt-CV: Config 11 is suboptimal. Config: {'num_factors': 179, 'confidence_scaling': 'linear', 'alpha': 32.14394136990316, 'epsilon': 0.08283815549882843, 'reg': 1.9852421095571765e-05, 'epochs0': 10, 'epochs1': 15, 'epochs2': 20, 'epochs3': 10, 'epochs4': 10} - results: ROC_AUC: 0.1336317, PRECISION: 0.0274617, PRECISION_RECALL_MIN_DEN: 0.1015165, RECALL: 0.0988065, MAP: 0.0445538, MRR: 0.0952183, NDCG: 0.0689009, F1: 0.0429735, HIT_RATE: 0.2746166, ARHR: 0.1068148, NOVELTY: 0.0049023, AVERAGE_POPULARITY: 0.0726420, DIVERSITY_MEAN_INTER_LIST: 0.9939767, DIVERSITY_HERFINDAHL: 0.9993788, COVERAGE_ITEM: 0.3206391, COVERAGE_ITEM_CORRECT: 0.0370433, COVERAGE_USER: 0.6639990, COVERAGE_USER_CORRECT: 0.1433245, DIVERSITY_GINI: 0.1138779, SHANNON_ENTROPY: 11.7533355, 
SearchBayesianSkopt-CV: Search complete. Best config is 3: {'num_factors': 126, 'confidence_scaling': 'log', 'alpha': 12.147774561179066, 'epsilon': 0.011140000925581263, 'reg': 0.00039864851116724637, 'epochs0': 10, 'epochs1': 30, 'epochs2': 20, 'epochs3': 15, 'epochs4': 10}
